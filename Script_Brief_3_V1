Bien démarrer : Installer Jenkins sur une machine virtuelle Linux Azure : https://docs.microsoft.com/fr-fr/azure/developer/jenkins/configure-on-linux-vm
Installer un fqdn : https://docs.microsoft.com/fr-fr/azure/dns/scripts/dns-cli-create-dns-zone-record

#!/bin/sh
az group create --name B3G4RG --location japaneast

<< ////
# Create a DNS zone. Substitute zone name "contoso.com" with the values for your own.
az network dns zone create -g B3G4RG -n testdns.com

# Create a DNS record. Substitute zone name "contoso.com" and IP address "1.2.3.4* with the values for your own.
az network dns record-set a add-record --g B3G4RG --z testdns.com --n www --a 1.2.3.4

# Get a list the DNS records in your zone
az network dns record-set list -g B3G4RG -z testdns.com
////

az vm create -n vmjenkins --resource-group B3G4RG --image Debian:debian-10:10:latest --generate-ssh-keys


# az vm wait # permet de mettre en attente la CLI jusqu'a ce qu'une condition soit remplie

# az group delete --name B3G4 --no-wait --yes

<< ////
# Pour monter Bastion :
az network vnet create --resource-group B3G4RG --name MyVnet --address-prefix 10.0.0.0/16 --subnet-name AzureBastionSubnet --subnet-prefix 10.0.0.0/24 --location japaneast
az network public-ip create --resource-group B3G4RG --name MyIp --sku Standard --location japaneast

# Pour créer un utilisateur avec droits admin : 
az vm create --admin-username azurenicolas
az vm create --admin-username azuredavid
az vm create --admin-username azuredunvael

# Disque : https://docs.microsoft.com/fr-fr/azure/virtual-machines/linux/add-disk

- Disque à ajouter : az vm disk attach -g B3G4RG --vm-name vmjenkins --name UserDataDisk --new --size-gb 50

- Répertorier les disques : lsblk -o NAME,HCTL,SIZE,MOUNTPOINT | grep -i "sd"

- Formater : sudo parted /dev/sdc --script mklabel gpt mkpart xfspart xfs 0% 100%
sudo mkfs.xfs /dev/sdc1
sudo partprobe /dev/sdc1

- Monter le disque : sudo mkdir /datadrive
- Monter le système de fichiers : sudo mount /dev/sdc1 /datadrive
- Rendre le montage permanent : sudo blkid
- ... à continuer
////

Créer un tunneling avec bastion => https://docs.microsoft.com/en-us/cli/azure/resource?view=azure-cli-latest#az-resource-update
https://docs.microsoft.com/en-us/rest/api/virtualnetwork/bastion-hosts/create-or-update?tabs=HTTP#request-body
az resource update --ids <bastion resource ids> --set properties.enableTunneling=True
